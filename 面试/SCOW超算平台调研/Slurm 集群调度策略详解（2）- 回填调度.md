
# 1. slurm 集群调度系统简介

作业调度系统其实就是指按一定策略把并行程序的各子任务或者是面向多用户的一组作业按一定的选择策略使之与各计算节点的空闲资源相对应，让其在对应的资源上运行，所以作业调度系统是联系上层应用和下层资源的中枢。一个集群资源的利用是否合理，各计算节点的负载是否均衡，以及各用户的用户体验是否良好都与作业调度系统息息相关，集群的资源管理及作业调度系统可谓是集群发展的重中之重。

Slurm 是一个开源，高度可扩展的集群管理工具和作业调度系统，可以简单理解为一个多机的资源和任务管理系统。主要以下提供三种关键功能：

**资源分配：**在特定时间段内为用户分配计算资源，进行独占或非独占访问权限，以便他们可以执行作业。简单的说就是为用户作业提供对计算资源的授权和分配。

**作业管理：**它提供了对节点上的作业节进行启动、执行和监控作业的框架。

**作业调度：**通过管理待处理作业的队列来仲裁资源的争用。例如根据优先级或不同调度策略调整资源的分配顺序。

Slurm 调度系统中针对作业的调度主要有三种，主调度，回填调度，GANG 调度。在之前的《slurm 集群调度策略详解（1）- 主调度》文章中，介绍了主调度的一些相关知识，本篇文章主要针对 slurm 中的回填调度进行解析。



# 2. 回填调度

## 2.1 回填调度算法简介

常见的先来先服务作业调度方法，实现简单、实用性很强。然而，为了保证公平性原则，当需要调度一个资源需求较大而现有空闲资源不能满足的大作业时，往往需要为其预留资源，这就容易产生大量闲置的资源碎片。回填算法，其允许为大作业预留资源的同时，也会将预约过程中产生的资源碎片进行分配；就是说可以让作业等待队列中排在后面的小作业跳过预约资源的大作业先于该大作业被调度执行，这样既避免了大作业长时间得不到调度而产生饥饿现象又可以让资源碎片得到充分利用，其能够很大程度上提高作业的平均响应时间，增加系统集群的吞吐量以及资源利用率。

目前，回填策略有很多种实现模式，比较典型的有 Easy Backfilling 和 Conservative Backfilling 两种策略算法，其它基于回填的调度策略的研究基本上都是在这两种策略基础上的微调。


![[Pasted image 20240331222013.png]]






