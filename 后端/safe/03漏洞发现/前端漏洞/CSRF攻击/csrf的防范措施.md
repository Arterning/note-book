

## csrf token
每次都返回一个token给客户端
客户端请求，需要携带token 服务端验证token是否正确。


感觉有点像验证码
不过目的不一样
token的目的是防止csrf 因为攻击者无法获取token 也就无法构造带有正确token的url
验证码的目的是区分是人在请求还是机器人在爆破


## 防御方案
1）当用户发送重要的请求时需要输入原始密码 
    这样限制攻击者无法在完全无感的情况下执行CSRF，用户也会因此警觉
2）设置随机 Token
  Token：给用户第一次登录时设定的唯一值（且足够随机），在作出请求的时候必须携带这个
  Token才会生效，一方面减少了重复请求量，一方面也避免了大部分CSRF攻击
3）同源策略，检验 referer 来源，请求时判断请求链接是否为当前管理员正在使用的页面
（管理员在编辑文章，黑客发来恶意的修改密码链接，因为修改密码页面管理员并没有在操作，所以攻击失败）
4）设置验证码
5）限制请求方式只能为 POST


## csrf的攻击方式
发个链接给受害者，诱导他点击。。

所以，无论是邮件里面，还是qq空间里面的各种不明链接
不要随便去点击。。

## 判断一个网站是否有csrf漏洞 
关键在于判断他对敏感信息的增删改查操作是否容易被伪造。

## csrf和xss的区别

csrf是发送一个链接给用户，是利用用户的权限完成攻击
xss是直接盗取了用户的cookie,然后实施破坏。


## 如何确认一个web系统存在csrf漏洞

1. 确认凭证的有效期，虽然退出了浏览器，但是cookie或者session仍然有效
2. 对目标网站的增删改查的地方进行标记 判断请求是否容易被伪造
比如修改管理员密码，没有验证旧密码
比如没有使用Token验证。
