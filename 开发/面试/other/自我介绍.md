我是17年毕业

毕业后第一份工作是在中软国际做一个运营商系统
一开始主要负责一个自动化部署升级工具的开发和维护
主要接触的是linux shell 这些
后来就是写一些api接口 页面 业务逻辑这种 



第二份工作是在蜜獾做一个私募基金的管理系统
在这里面参与了下面几个任务
一个是页面的性能优化
这个任务的背景是这样
我们那个系统也是一个2b的web系统 很多地方都有性能问题
尤其是用户第一次打开某一些页面的或者访问某些api的时候，需要很长的等待时间

1. 我们第一步是先分析了一下那个代码
然后发现他为什么第一次加载需要很长时间，就是因为他第一次打开的时候需要去数据库读取基金的所有历史数据 然后load到缓存里面
而且他是把很多数据一次性读取出来 而且他底层的那个数据是blob类型存储的 load的过程还涉及到反序列化 所以是非常慢的

2. 后来我们发现缓存里面的内容并不是所有的都是有用的，有很多数据他并不会展示在页面上 但是他也加载到缓存里面了
所以我们想到的第一个办法就是将页面所需要用到的热点数据做一个快照 设计一张表来存储 同时也设计快照缓存

3. 然后我们把缓存结构做了重构
原先的缓存是一个层级关系的map 就是基金下有多个账户，账户下有多笔交易
比如界面或者api需要拿这个基金的表现数据的时候 他会把这个基金下所有账户和交易的数据都load到缓存中
我们现在有了快照之后 就可以只加载基金的快照缓存就行了 这个数据量是非常小的 所以打开页面就很快了

4. 然后我们用那个guava cache替换了原先的concurrent hashmap
因为他那个更灵活 可以指定缓存的清除策略 用的少的数据释放掉 节省内存
而且提供的api也更方便






一个是计算模块的性能优化
这个计算模块就是计算基金账户的各种指标数据 说简单点就是一个很大的map key就是名字 value就是BigDecimal
他这个计算模块原先也是比较慢的
所以我们就做了一些改造
1. 第一就是考虑用多线程 因为基本上这属于一个cpu密集型的任务
因为他原本的计算是基金下所有的账户是在一个for循环中顺序执行的 账户的数量是很多的，多的可以到有几万个账户
所以我们就想多线程来分解这个for循环
确实是有一些代码是可以并行处理的 比如一个账户计算成之后是一个map对象 把这个map对象存储到数据库之前 需要做一些格式和结构上的转换 还有序列化成字节数组
这部分工作是并行的 所以我们把这部分就并行处理了

但是还有一部分代码是没办法完全并行处理的 就是这个计算过程 因为账户之间可转账 产生关联
比如说这个月初A把自己的钱的20%转钱给B 那么你就必须先计算A在月初有多少钱 你才能计算B 所以是一个依赖关系
而且大部分账户都是有这种情况的
所以要用多线程的话这就涉及到一个线程同步的问题
所以我们用DAG做了一个任务编排
接下来我们要做的事其实很简单，就是 BFS 广度优先算法 遍历
这整个 DAG 数据结构，然后提交到线程池中去执行就可以了，过程中注意一些节点状态的保持，结果的保存即可。


while (notFinished) {
    doProcessNodes(root.getChildrens())
}

private void doProcessNodes(final Set<Node<T, R>> nodes) {
    for (Node<T, R> node : nodes) {
        if (!processedNodes.contains(node) && processedNodes.containsAll(node.getParents())) {
            Task<T, R> task = newTask(node);
            this.executionEngine.submit(task);
            ...
            ExecutionResult<T, R> executionResult = this.executionEngine.processResult();
            if (executionResult.isSuccess()) {
                state.markProcessingDone(processedNode);
            }
            //继续执行孩子节点
            doProcessNodes(processedNode.getChildrens());
            ...
        }
    }
}



2. 另外就是计算需要从数据库中读取很多数据，原来是用的hibernate 通过一份封装的对象去拿数据
性能不是很好 也存在一个问题 就是你读取了计算过程中根本不需要的数据
所以我们用jdbc做了重构 


3. 后来还计划把这个做成微服务来着


还有就是写了一些前后端分离的项目 接触了react json api这些
另外也负责了一些自动化测试用例的维护 比如自动化web测试的脚本 Junit这些
还有就是做了很多UI改造的项目 主要是jsp jquery css这些
我不太喜欢改页面 也感觉没什么意思 所以就不仔细说这个了

